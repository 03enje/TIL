# 형 변환 함수
- 오라클에서 데이터형으로 변환해야 하는 경우에는 TO_NUMBER, TO_CHAR, TO_DATE를 사용

|구분|설명|
|----|----|
|TO_CHAR|날짜형 혹은 숫자형을 문자형으로 변환|
|TO_DATE|문자형을 날짜형으로 변환|
|TO_NUMBER|문자형을 숫자형으로 변환|

## TO_CHAR(날짜 데이터, '출력형식')
```SQL
-- TO_CHAR는 문자 포맷을 지정해서 출력하고 싶을때 주로 사용
SELECT TO_CHAR(SYSDATE, 'YYYY/MM/DD HH24:MI:SS') FROM DUAL;

출력:
TO_CHAR(SYSDATE,'YYYY/MM/DDHH24:MI:SS'
--------------------------------------
2022/11/30 14:53:39

SELECT SYSDATE
     , TO_CHAR(SYSDATE, 'MM')
     , TO_CHAR(SYSDATE, 'MON')
     , TO_CHAR(SYSDATE, 'MONTH')
     , TO_CHAR(SYSDATE, 'DD')
     , TO_CHAR(SYSDATE, 'DY')
     , TO_CHAR(SYSDATE, 'DAY')
  FROM DUAL;

출력:
SYSDATE  TO_C TO_CHAR(SYSDATE, TO_CHAR(SYSDATE, TO_C TO_CHAR( TO_CHAR(SYSDATE,'DAY')
-------- ---- ---------------- ---------------- ---- -------- ------------------------
22/11/30 11   11월             11월             30   수       수요일

SELECT ENAME, HIREDATE, TO_CHAR(HIREDATE, 'YY-MM'), TO_CHAR(HIREDATE, 'YYYY/MM/DD DAY') FROM EMPLOYEE;

출력:
ENAME                HIREDATE TO_CHAR(HI TO_CHAR(HIREDATE,'YYYY/MM/DDDAY')
-------------------- -------- ---------- ----------------------------------------------
SMITH                80/12/17 80-12      1980/12/17 수요일
ALLEN                81/02/20 81-02      1981/02/20 금요일
WARD                 81/02/22 81-02      1981/02/22 일요일

-- 숫자열에 문자를 더하여 출력하기
SELECT ENAME, ENO, ENO + '500'
  FROM EMPLOYEE
 WHERE ENAME = 'SCOTT';
 
출력:
ENAME                       ENO  ENO+'500'
-------------------- ---------- ----------
SCOTT                      7788       8288

-- 문자열과 숫자를 더하여 출력하기(숫자로 인식 가능한 문자만 가능)
SELECT '500' + ENO, ENO
  FROM EMPLOYEE
 WHERE ENAME = 'SCOTT';
 
출력:
  '500'+ENO        ENO
---------- ----------
      8288       7788
```

### --
# 일반 함수
## NVL(EXPR1, EXPR2)
> NULL을 0또는 다른 값으로 변환하기 위해서 사용하는 함수
```SQL
SELECT ENAME, SALARY, COMMISSION, NVL(COMMISSION, 0), SALARY*12+NVL(COMMISSION, 0) FROM EMPLOYEE ORDER BY JOB;

출력:
ENAME                    SALARY COMMISSION NVL(COMMISSION,0) SALARY*12+NVL(COMMISSION,0)
-------------------- ---------- ---------- ----------------- ---------------------------
SCOTT                      3000                            0                       36000
FORD                       3000                            0                       36000
MILLER                     1300                            0                       15600
```
## NVL2(EXPR1, EXPR2, EXPR3)
> EXPR1을 검사하여 그 결과가 널이 아니면 EXPR2를 반환하고 널이면 EXPR3을 반환
```SQL
SELECT ENO, ENAME, COMMISSION
     , NVL2(COMMISSION, '존재', '부재')
  FROM EMPLOYEE;
  
출력:
       ENO ENAME                COMMISSION NVL2(COMMISS
---------- -------------------- ---------- ------------
      7369 SMITH                           부재
      7499 ALLEN                       300 존재
      7521 WARD                        500 존재
      7566 JONES                           부재
      7654 MARTIN                     1400 존재
      7698 BLAKE                           부재
```

## NVLIF(EXPR1, EXPR2)
> 두 표현식을 비교하여 동일한 경우에는 널을 반환하고 동일하지 않으면 첫 번째 표현식을 반환
```SQL
SELECT NULLIF('A', 'A'), NULLIF('A', 'B') FROM DUAL;

출력:
NU NU
-- --
   A
```
## DECODE
DECODE(표현식, 조건1, 결과1   
　　　　　　　, 조건2, 결과2   
　　　　　　　, 조건3, 결과3   
　　　　　　　기본결과n)
```SQL
SELECT ENO, ENAME, JOB, SALARY
     , DECODE(JOB,
               'MANAGE', SALARY*1.1,
               'SALESMAN', SALARY*1.05,
               'ANALYST', SALARY,
               SALARY*1.03) AS UPSALARY
  FROM EMPLOYEE;

출력:
       ENO ENAME                JOB                    SALARY   UPSALARY
---------- -------------------- ------------------ ---------- ----------
      7369 SMITH                CLERK                     800        824
      7499 ALLEN                SALESMAN                 1600       1680
      7521 WARD                 SALESMAN                 1250     1312.5
      7566 JONES                MANAGER                  2975    3064.25
      7654 MARTIN               SALESMAN                 1250     1312.5
```
## CASE
CASE 표현식 WHEN 조건1 THEN 결과1   
　　　　　　WHEN 조건2 THEN 결과2   
　　　　　　WHEN 조건3 THEN 결과3   
　　　　　　ELSE 결과n   
END
```SQL
SELECT ENO, ENAME, JOB, SALARY
     , CASE JOB
            WHEN 'MANAGER' THEN SALARY*1.1
            WHEN 'SALESMAN' THEN SALARY*1.05
            WHEN 'ANALYST' THEN SALARY
            ELSE SALARY*1.03
        END AS UPSALARY
  FROM EMPLOYEE;
  
출력:
       ENO ENAME                JOB                    SALARY   UPSALARY
---------- -------------------- ------------------ ---------- ----------
      7369 SMITH                CLERK                     800        824
      7499 ALLEN                SALESMAN                 1600       1680
      7521 WARD                 SALESMAN                 1250     1312.5
      7566 JONES                MANAGER                  2975     3272.5
      7654 MARTIN               SALESMAN                 1250     1312.5
      
SELECT ENO, ENAME, COMMISSION
       , CASE
            WHEN COMMISSION IS NULL THEN '해당사항 없음'
            WHEN COMMISSION = 0 THEN '수당없음'
            WHEN COMMISSION > 0 THEN '수당 : ' || COMMISSION
         END AS COMM_TEXT
  FROM EMPLOYEE;

출력:
       ENO ENAME                COMMISSION COMM_TEXT
---------- -------------------- ---------- --------------------------------------------------------------------------------------------------
      7369 SMITH                           해당사항 없음
      7499 ALLEN                       300 수당 : 300
      7566 JONES                           해당사항 없음
      7654 MARTIN                     1400 수당 : 1400
      7698 BLAKE                           해당사항 없음
      7844 TURNER                        0 수당없음
```

## 정리
```SQL
-- EMP 테이블에서 사원들은 입사일을 기준으로 3개월이 지난 후 첫 월요일에 정직원
-- 사원들이 정직원이 되는 날짜(R_JOB)를 'YYYY-MM-DD'형식으로 출력
-- 단, 추가 수당(COMMISSION)이 없는 사원의 추가 수당은 N/A로 출력

SELECT ENO, ENAME, HIREDATE, NVL(TO_CHAR(COMMISSION), 'N/A') AS "COMM"
     , TO_CHAR(NEXT_DAY(ADD_MONTHS(HIREDATE, 3), '월요일'), 'YYYY-MM-DD') AS "R_JOB"
  FROM EMPLOYEE;
  
출력:
      ENO ENAME                HIREDATE COMM                                                                             R_JOB
---------- -------------------- -------- -------------------------------------------------------------------------------- --------------------
      7369 SMITH                80/12/17 N/A                                                                              1981-03-23
      7499 ALLEN                81/02/20 300                                                                              1981-05-25
      7521 WARD                 81/02/22 500                                                                              1981-05-25
      7566 JONES                81/04/02 N/A                                                                              1981-07-06
      7654 MARTIN               81/09/28 1400                                                                             1982-01-04
```
## 정리
```SQL
SELECT ENO, ENAME, MANAGER
     , CASE 
            WHEN MANAGER IS NULL THEN '0000'
            WHEN TO_CHAR(SUBSTR(MANAGER, 1, 2)) = '75' THEN '5555'
            WHEN TO_CHAR(SUBSTR(MANAGER, 1, 2)) = '76' THEN '6666'
            WHEN TO_CHAR(SUBSTR(MANAGER, 1, 2)) = '77' THEN '7777'
            WHEN TO_CHAR(SUBSTR(MANAGER, 1, 2)) = '78' THEN '8888'
            ELSE TO_CHAR(MANAGER)
       END AS CHG_MANAGER
FROM EMPLOYEE;

출력:
       ENO ENAME                   MANAGER CHG_MANAGER
---------- -------------------- ---------- --------------------------------------------------------------------------------
      7369 SMITH                      7902 7902
      7499 ALLEN                      7698 6666
      7521 WARD                       7698 6666
      7566 JONES                      7839 8888
      7654 MARTIN                     7698 6666
      7698 BLAKE                      7839 8888
      7782 CLARK                      7839 8888
      7788 SCOTT                      7566 5555
      7839 KING                            0000
      7844 TURNER                     7698 6666
      7876 ADAMS                      7788 7777
      7900 JAMES                      7698 6666
      7902 FORD                       7566 5555
      7934 MILLER                     7782 7777
```